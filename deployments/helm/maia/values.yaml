# MAIA Helm Chart Values
# Default values for MAIA deployment

# Number of replicas (for stateless mode, requires external storage)
replicaCount: 1

image:
  repository: ghcr.io/ar4mirez/maia
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion
  tag: ""

imagePullSecrets: []
nameOverride: ""
fullnameOverride: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use
  name: ""

podAnnotations: {}

podSecurityContext:
  fsGroup: 1000

securityContext:
  capabilities:
    drop:
      - ALL
  readOnlyRootFilesystem: true
  runAsNonRoot: true
  runAsUser: 1000

service:
  type: ClusterIP
  port: 8080
  annotations: {}

ingress:
  enabled: false
  className: ""
  annotations: {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: maia.local
      paths:
        - path: /
          pathType: Prefix
  tls: []
  #  - secretName: maia-tls
  #    hosts:
  #      - maia.local

resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 100m
    memory: 256Mi

autoscaling:
  enabled: false
  minReplicas: 1
  maxReplicas: 10
  targetCPUUtilizationPercentage: 80
  targetMemoryUtilizationPercentage: 80

nodeSelector: {}

tolerations: []

affinity: {}

# Persistence configuration
persistence:
  enabled: true
  storageClass: ""
  accessMode: ReadWriteOnce
  size: 10Gi
  annotations: {}

# MAIA Configuration
maia:
  # Log configuration
  log:
    level: info
    format: json

  # Storage configuration
  storage:
    dataDir: /data
    # BadgerDB specific settings
    syncWrites: false
    gcInterval: 5m

  # Security configuration
  security:
    # API key for authentication (use secret reference in production)
    apiKey: ""
    # Reference to existing secret containing API key
    existingSecret: ""
    existingSecretKey: "api-key"

  # Embedding configuration
  embedding:
    model: local
    # For OpenAI embeddings
    openai:
      apiKey: ""
      existingSecret: ""
      existingSecretKey: "openai-api-key"

  # Multi-tenancy configuration
  tenant:
    enabled: false
    requireTenant: false
    defaultTenantId: "default"
    dedicatedStorageDir: ""
    enforceScopesEnabled: false

  # Rate limiting
  rateLimit:
    enabled: false
    requestsPerSecond: 100
    burst: 200

  # Server configuration
  server:
    readTimeout: 30s
    writeTimeout: 30s
    idleTimeout: 120s
    maxHeaderBytes: 1048576

# Prometheus metrics
metrics:
  enabled: true
  serviceMonitor:
    enabled: false
    namespace: ""
    interval: 30s
    scrapeTimeout: 10s
    labels: {}

# Health checks
healthCheck:
  livenessProbe:
    httpGet:
      path: /health
      port: http
    initialDelaySeconds: 10
    periodSeconds: 10
    timeoutSeconds: 5
    failureThreshold: 3
  readinessProbe:
    httpGet:
      path: /ready
      port: http
    initialDelaySeconds: 5
    periodSeconds: 5
    timeoutSeconds: 3
    failureThreshold: 3

# Extra environment variables
extraEnv: []
#  - name: EXTRA_VAR
#    value: "extra-value"

# Extra volumes
extraVolumes: []
#  - name: extra-volume
#    emptyDir: {}

# Extra volume mounts
extraVolumeMounts: []
#  - name: extra-volume
#    mountPath: /extra

# Backup configuration
backup:
  # Enable scheduled backups
  enabled: false

  # Cron schedule (default: daily at 2 AM)
  schedule: "0 2 * * *"

  # Compress backups with gzip
  compress: true

  # Number of days to keep backups
  retentionDays: 30

  # Job history
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 3

  # Resources for backup job
  resources:
    limits:
      cpu: 500m
      memory: 512Mi
    requests:
      cpu: 100m
      memory: 128Mi

  # Backup storage
  persistence:
    enabled: true
    storageClass: ""
    accessMode: ReadWriteOnce
    size: 20Gi
